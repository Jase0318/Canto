<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CantoLearn AI - 粵語學習助手 (Pro穩定版)</title>
    
    <!-- 1. 樣式 -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. 核心函式庫 (使用 Cloudflare CDN，最穩定) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              chinese: ['Noto Sans TC', 'sans-serif'],
            },
            colors: {
              teal: { 50: '#f0fdfa', 100: '#ccfbf1', 500: '#14b8a6', 600: '#0d9488', 700: '#0f766e' }
            }
          }
        }
      }
    </script>
    <style>
      body { background-color: #f8fafc; }
      #root:empty { display: none; }
      .scrollbar-hide::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans antialiased">

    <!-- 系統狀態監控 (純 JS，保證執行) -->
    <div id="loading-screen" class="fixed inset-0 flex items-center justify-center flex-col gap-4 bg-slate-50 z-[9999] transition-opacity duration-500">
        <div class="w-12 h-12 border-4 border-teal-100 border-t-teal-600 rounded-full animate-spin"></div>
        <div class="text-center">
            <div class="font-bold text-slate-700 text-lg">系統啟動中...</div>
            <div id="debug-text" class="text-xs text-slate-400 mt-2 font-mono">Loading Core Libraries...</div>
        </div>
        <button id="retry-btn" onclick="window.location.reload()" class="hidden px-4 py-2 bg-red-500 text-white rounded shadow text-sm hover:bg-red-600">
            重新整理
        </button>
    </div>

    <script>
        // 安全檢查：如果 5 秒後 Loading 還在，代表 React 掛了
        setTimeout(() => {
            const loader = document.getElementById('loading-screen');
            const debug = document.getElementById('debug-text');
            if (loader && loader.style.display !== 'none') {
                debug.innerHTML = '⚠️ 啟動逾時。<br>可能原因：CDN 連線被擋或是舊緩存。<br>請按 Ctrl+F5 強制重整。';
                debug.style.color = 'red';
                document.getElementById('retry-btn').classList.remove('hidden');
            }
        }, 6000);

        window.onerror = function(msg, url, line) {
            const debug = document.getElementById('debug-text');
            debug.innerHTML = `錯誤: ${msg} (Line: ${line})`;
            debug.style.color = 'red';
            return false;
        };
    </script>

    <!-- React 掛載點 -->
    <div id="root"></div>

    <!-- 主程式邏輯 -->
    <script type="text/babel">
        // React 啟動後，立刻移除 Loading 畫面
        try {
            const loader = document.getElementById('loading-screen');
            if(loader) {
                loader.style.opacity = '0';
                setTimeout(() => loader.style.display = 'none', 500);
            }
        } catch(e) { console.error(e); }

        const { useState, useEffect, useMemo } = React;

        // --- 圖示元件 ---
        const Icons = {
            Sparkles: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 9v4"/><path d="M3 5h4"/><path d="M9 3v2"/></svg>,
            Search: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
            Trash2: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>,
            X: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Volume2: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>,
            KeyRound: ({className}) => <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentC
